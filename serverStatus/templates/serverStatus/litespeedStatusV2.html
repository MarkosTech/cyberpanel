{% extends "baseTemplate/newBase.html" %}
{% load i18n %}
{% block titleNew %}{% trans "Home - CyberPanel" %}{% endblock %}
{% block newContent %}

    {% load static %}

    {% if OLS %}
        <div ng-controller="litespeedStatusV2" class="p-8">
            <div>
                <div class="flex items-center">
                    <p class="text-4xl font-bold">LiteSpeed Status:</p>
                    <img src="{% static 'images/lsON.png' %}"
                         style="margin-bottom: 5px;">
                </div>
                <p class="text-xs text-gray-600 py-2 font-semibold">On this page you can get information regarding your
                    LiteSpeed processes.</p>
            </div>
            {% if processList %}
                <div>
                    <div class="flex items-center py-4">
                        <p class="text-xl font-bold">LiteSpeed Processes</p>
                    </div>
                    <hr>
                    <div class="relative py-5 overflow-x-auto">
                        <table class="w-full text-sm text-left rtl:text-right">
                            <thead>
                            <tr>
                                <th scope="col" class="px-6 py-3">
                                    #
                                </th>
                                <th scope="col" class="px-6 py-3">
                                    Process ID
                                </th>
                                <th scope="col" class="px-6 py-3">
                                    Name
                                </th>
                            </tr>
                            </thead>
                            <tbody class="border shadow-lg py-3 px-6 rounded-b-lg">
                            {% for items in processList %}
                                <tr>
                                <td class="px-6 py-4">
                                    {{ forloop.counter }}
                                </td>
                                <td class="px-6 py-4">
                                    {{ items }}
                                </td>
                                {% if forloop.counter == 1 %}
                                    <td class="px-6 py-4">
                                        Main Process
                                    </td>
                                {% elif forloop.counter == 2 %}
                                    <td class="px-6 py-4">
                                        lscgid Process
                                    </td>
                                {% else %}
                                    <td class="px-6 py-4">
                                        Worker Process
                                    </td>
                                {% endif %}
                            {% endfor %}
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="mx-10">
                    <button ng-click="restartLitespeed()" ng-disabled="disableReboot"
                            class="btn btn-alt btn-hover btn-blue-alt mx-5 my-10">
                        <span>{% trans "Reboot Litespeed" %}</span>
                        <i class="glyph-icon icon-arrow-right"></i>
                    </button>

                    <button ng-click="stopLitespeed()" ng-disable="disableStop"
                            class="btn btn-alt btn-hover btn-danger mx-5 my-10">
                        <span>{% trans "Stop LiteSpeed" %}</span>
                        <i class="glyph-icon icon-arrow-right"></i>
                    </button>
                </div>

                <img ng-hide="restartorStopLoading" src="{% static 'images/loading.gif' %}">

                <div ng-hide="actionResult" class="flex justify-center bg-green-500 px-2 rounded-lg py-1 font-semibold">
                    <p>{% trans "Action successful." %}</p>
                </div>
                <div ng-hide="actionResultBad"
                     class="flex justify-center bg-red-500 rounded-lg text-white px-2 py-1 font-semibold">
                    <p>{% trans "Error Occurred. See CyberPanel main log file." %}</p>
                </div>
                <div ng-hide="serverStatusCouldNotConnect"
                     class="flex justify-center bg-red-500 rounded-lg text-white px-2 py-1 font-semibold">
                    <p>{% trans "Could not connect to server." %}</p>
                </div>
            {% endif %}
        </div>
        <div ng-controller="lswsSwitchV2" class="p-8">
            <div>
                <div class="flex items-center">
                    <p class="text-4xl font-bold">Switch to LiteSpeed Enterprise Web Server</p>
                    <img ng-hide="cyberPanelLoading"
                         src="/static/images/loading.gif">
                </div>
            </div>
            <div>
                <div class="flex py-2 px-6">
                    <div>
                        <p class="font-semibold w-60">LiteSpeed Serial No. (License Key)</p>
                    </div>
                    <div>
                        <input type="text" class="w-80 bg-gray-100 rounded px-2 py-1" ng-model="licenseKey"
                               required>
                    </div>
                </div>
                <hr>
            </div>
            <div class="col-sm-4">
                <button type="button" ng-click="switchTOLSWS()"
                        class="btn btn-primary btn-lg">{% trans "Switch" %}</button>
                <button type="button" ng-click="confrimtril()"
                        class="btn btn-primary btn-lg">{% trans "Get 15 Days Trial" %}</button>
            </div>

            <div id="confrimtril" style="display: none" class="form-group ">
                <div class="col-sm-4">
                    <button type="button" ng-click="switchTOLSWS()"
                            class="btn btn-primary btn-lg">{% trans "Are you sure?" %}</button>
                </div>
            </div>
            <div class="alert alert-info">
                <p>{% trans "Note: If you select 15 days trial there is no need to enter the serial key, CyberPanel will auto fetch 15 days trial key for you. Make sure this server have not used trial already." %}</p>
            </div>
            <div class="alert alert-info">
                <p style="color:red; font-weight: bold ;">{% trans "WARNING: You cannot revert back to OpenLiteSpeed if you choose not to purchase a LiteSpeed Enterprise license after the 15 day trial period. We recommend you test the Enterprise trial on a separate server." %}</p>
            </div>
            <div style="margin-top: 2%" ng-hide="installBoxGen">
                <form action="/" id="">
                    <div>
                        <div class="flex items-center">
                            <img style="width:70px"
                                 src="{% static 'images/litespeed-logo.png' %}">
                            <p class="text-4xl font-bold">With great wisdom comes great responsibility.</p>
                            <img ng-hide="cyberPanelLoading" src="/static/images/loading.gif">
                        </div>
                        <div style="margin-top: 2%;">
                            <textarea ng-model="requestData" rows="15"
                                      class="border w-full">{{ requestData }}</textarea>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    {% else %}
        <div ng-controller="litespeedStatusV2" class="p-8">
            <div>
                <div class="flex items-center">
                    <p class="text-4xl font-bold">LiteSpeed Status:</p>
                    <img src="{% static 'images/lsON.png' %}">
                </div>
                <p class="text-xs text-gray-600 py-2 font-semibold">On this page you can get information regarding your
                    LiteSpeed processes.</p>
            </div>
            <div>
                {% if message != 0 %}
                    {% if message == 2 %}
                        <div style="margin-top: 2%" class="alert alert-danger">
                            <div class="alert-content">
                                <h4 class="alert-title">Warning</h4>
                                <p>It looks like your license does not include CyberPanel bundle. <a
                                        href="https://cyberpanel.net/cyberpanel-enterprise/">Click here</a> to see the
                                    packages and upgrade to CyberPanel bundle.</p>
                            </div>
                        </div>
                    {% else %}
                        <div style="margin-top: 2%" class="alert alert-danger">
                            <div class="alert-content">
                                <h4 class="alert-title">Warning</h4>
                                <p>It looks like your license has expired. Kindly renew your license.</p>
                            </div>
                        </div>
                    {% endif %}
                {% endif %}
                <hr>
                {% if processList %}

                    <div class="example-box-wrapper">
                        <div class="panel">
                            <div class="panel-body">
                                <div class="col-md-12">
                                    <div class="example-box-wrapper">


                                        <h3 class="content-box-header bg-black">
                                            {% trans "LiteSpeed Processes" %}
                                        </h3>

                                        <table class="table">
                                            <thead>
                                            <tr>
                                                <th>#</th>
                                                <th>{% trans "Process ID" %}</th>
                                                <th>{% trans "Name" %}</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            {% for items in processList %}
                                                <tr>
                                                <td>{{ forloop.counter }}</td>

                                                <td> {{ items }}</td>

                                                {% if forloop.counter == 1 %}
                                                    <td>{% trans "Main Process" %}</td>

                                                {% elif forloop.counter == 2 %}
                                                    <td>{% trans "lscgid Process" %}</td>

                                                {% else %}
                                                    <td>{% trans "Worker Process" %}</td>

                                                {% endif %}

                                            {% endfor %}
                                            </tr>
                                            </tbody>
                                        </table>


                                        <button ng-click="restartLitespeed()" ng-disabled="disableReboot"
                                                class="btn btn-alt btn-hover btn-blue-alt mx-5 my-10">
                                            <span>{% trans "Reboot Litespeed" %}</span>
                                            <i class="glyph-icon icon-arrow-right"></i>
                                        </button>

                                        <button ng-click="stopLitespeed()" ng-disable="disableStop"
                                                class="btn btn-alt btn-hover btn-danger mx-5 my-10">
                                            <span>{% trans "Stop LiteSpeed" %}</span>
                                            <i class="glyph-icon icon-arrow-right"></i>
                                        </button>

                                        <img ng-hide="restartorStopLoading" src="{% static 'images/loading.gif' %}">


                                        <div ng-hide="actionResult" class="alert alert-success">
                                            <p>{% trans "Action successful." %}</p>
                                        </div>


                                        <div ng-hide="actionResultBad" class="alert alert-danger">
                                            <p>{% trans "Error Occurred. See CyberPanel main log file." %}</p>
                                        </div>


                                        <div ng-hide="serverStatusCouldNotConnect" class="alert alert-danger">
                                            <p>{% trans "Could not connect to server." %}</p>
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                {% endif %}
                <div class="example-box-wrapper">
                    <div class="panel panel-body">
                        <h3 class="content-box-header">
                            {% trans "License Manager" %} <img ng-hide="cpLoading" src="/static/images/loading.gif">
                        </h3>

                        <div class="content-box-wrapper">
                            <div class="row mt-5 mx-10">

                                <div class="col-md-4 panel-body">
                                    <a ng-click="licenseStatus(1)" href="" title="{% trans 'License Status' %}">
                                        <img src="{% static 'images/license-status.png' %}" width="65" class="mr-10 ">
                                    </a>
                                    &nbsp;
                                    <a ng-click="licenseStatus(1)" href="" title="{% trans 'License Status' %}">
                                        <span class="h4">{% trans 'License Status' %}</span>
                                    </a>
                                </div>

                                <div class="col-md-4 panel-body">
                                    <a ng-click="showSerialBox()" href="" title="{% trans 'Change License' %}">
                                        <img src="{% static 'images/change-license.png' %}" width="65" class="mr-10">
                                    </a>
                                    &nbsp;
                                    <a ng-click="showSerialBox()" href="" title="{% trans 'Change License' %}">
                                        <span class="h4">{% trans 'Change License' %}</span>
                                    </a>

                                </div>

                                <div class="col-md-4 panel-body">
                                    <a ng-click="refreshLicense()" href="" title="{% trans 'Refresh License' %}">
                                        <img src="{% static 'images/change-license.png' %}" width="65" class="mr-10">
                                    </a>
                                    &nbsp;
                                    <a ng-click="refreshLicense()" href="" title="{% trans 'Refresh License' %}">
                                        <span class="h4">{% trans 'Refresh License' %}</span>
                                    </a>

                                </div>

                                <div class="col-md-12">

                                    <div ng-hide="fetchedData">
                                        <div class="alert alert-success">
                                            <div class="bg-green alert-icon">
                                                <i class="glyph-icon icon-check"></i>
                                            </div>
                                            <div class="alert-content">
                                                <h4 class="alert-title">{$ lsSerial $}</h4>
                                                <p>{$ lsexpiration $}</p>
                                            </div>
                                        </div>
                                    </div>

                                </div>

                                <!---------- HTML For Changing Serial No --------------->

                                <div ng-hide="changeSerialBox" class="col-md-12">
                                    <form action="/" class="form-horizontal bordered-row">

                                        <div class="form-group">
                                            <label class="col-sm-3 control-label">{% trans "New key" %}</label>
                                            <div class="col-sm-6">
                                                <input type="text" class="form-control" ng-model="newKey" required>
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <label class="col-sm-3 control-label"></label>
                                            <div class="col-sm-4">
                                                <button type="button" ng-click="changeLicense()"
                                                        class="btn btn-primary btn-lg">{% trans "Change Key" %}</button>
                                            </div>
                                        </div>

                                    </form>
                                </div>

                                <!---------- HTML For Changing Serial No --------------->


                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    {% endif %}
{% endblock %}
